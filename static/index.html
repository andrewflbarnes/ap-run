<!DOCTYPE html>
<html>
  <head>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- custom site css -->
    <link rel="stylesheet" href="./ap-run.css">
    <!-- bootstrap 4.4 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script>
      $(document).ready(function() {
        $('#training-button').one('click', function() {
          console.log("appending")
          $('#strava-iframe-holder').append(`
            <div class="col-12 col-md-6">
              <iframe height='454' width='300' frameborder='0' allowtransparency='true' scrolling='no' src='https://www.strava.com/athletes/33469609/latest-rides/b3dbbc84274e355f391282d32ebbf0b6c9f056d2'></iframe>
            </div>
            <div class="col-12 d-md-none">&nbsp;</div>
            <div class="col-12 col-md-6">
              <iframe height='454' width='300' frameborder='0' allowtransparency='true' scrolling='no' src='https://www.strava.com/athletes/37738357/latest-rides/28421c06108e4445f5b748e881844f4724f173fd'></iframe>
            </div>
          `)
        })

        fetch('http://localhost:3000/sweepstake', {
          method: 'GET'
        }).then(function(res) {
          return res.json();
        }).then(function(res) {
          console.log(res);

          res.forEach(function(entry) {
            $('#sweepstake-entries').append(`
              <tr>
                <td scope="row">${entry.name}</td>
                <td>${entry.time}</td>
                <td>${entry.message}</td>
              </tr>`
            );
          });
        });
      });
    </script>
  </head>
  <body>
    <main role="main" class="container text-center justify-content-center">
      <div>
        <div class="my-5">
          <h1>26.2 Miles for Salcombe RNLI</h1>
        </div>
        <div>
          <p>
            Andrew and Penny are running the Manchester Marathon in April to raise money for the Salcombe RNLI.
          </p>
          <p>
            To read more about their challenge, or donate, visit their <a href="https://uk.virginmoneygiving.com/Team/PennyandAndrew">fundraising</a> page.
          </p>
        </div>
      </div>
      
      <div class="accordion mt-5" id="running-accordian">

        <!-- Sweepstake -->
        <div class="card">
          <div class="card-header" id="sweepstake-header">
            <h2 class="mb-0">
              <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#sweepstake-collapse" aria-expanded="true" aria-controls="sweepstake-collapse">
                Sweepstake
              </button>
            </h2>
          </div>
      
          <div id="sweepstake-collapse" class="collapse" aria-labelledby="sweepstake-heading" data-parent="#running-accordian">
            <div class="card-body">
              <div class="row justify-content-center">
                <div class="col-12">
                  <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Time</th>
                        <th scope="col">Message</th>
                      <tr>
                    </thead>
                    <tbody id="sweepstake-entries">
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Training -->
        <div class="card">
          <div class="card-header" id="training-header">
            <h2 class="mb-0">
              <button id="training-button" class="btn btn-link" type="button" data-toggle="collapse" data-target="#training-collapse" aria-expanded="true" aria-controls="training-collapse">
                Training
              </button>
            </h2>
          </div>
      
          <div id="training-collapse" class="collapse" aria-labelledby="training-heading" data-parent="#running-accordian">
            <div class="card-body">
              <!-- Strava widgets -->
              <div id="strava-iframe-holder" class="row justify-content-center">
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12">&nbsp;</div>
    </main>
    <!-- Sticky footer -->
    <footer class="footer justify-content-center">
      <div class="container text-center">
        <span class="text-muted">
          <a href="https://uk.virginmoneygiving.com/Team/PennyandAndrew">Donate</a>
        </span>
      </div>
    </footer>
  </body>
</html>
